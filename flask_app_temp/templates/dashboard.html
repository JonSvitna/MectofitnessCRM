{% extends "base.html" %}

{% block title %}Dashboard - MectoFitness{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/gym-pro-theme.css') }}">
{% endblock %}

{% block content %}
<div class="container" style="padding-top: var(--space-8); padding-bottom: var(--space-8);">
    <!-- Professional Header with Gamification -->
    <div class="page-header">
        <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: var(--space-4);">
            <div>
                <h1 class="page-title">Welcome Back, {{ current_user.full_name }}</h1>
                <p class="page-subtitle">Let's crush today's training goals ðŸ’ª</p>
            </div>
            <div style="display: flex; gap: var(--space-3); align-items: center;">
                <div class="level-badge">
                    <span style="font-size: 1.25rem;">âš¡</span>
                    <span>Level 5</span>
                </div>
                <div class="streak-badge">
                    <span class="streak-flame">ðŸ”¥</span>
                    <span>7 Day Streak</span>
                </div>
            </div>
        </div>
    </div>

    <!-- XP Progress Bar -->
    <div style="margin-bottom: var(--space-8);">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-2);">
            <span class="text-overline">Progress to Level 6</span>
            <span style="font-size: var(--text-sm); font-weight: var(--font-semibold); color: var(--text-secondary);">750 / 1000 XP</span>
        </div>
        <div class="xp-bar">
            <div class="xp-bar-fill" style="width: 75%;"></div>
            <div class="xp-text">75% Complete</div>
        </div>
    </div>
    
    <!-- Statistics Dashboard -->
    <div class="grid-4" style="margin-bottom: var(--space-8);">
        <div class="stat-card">
            <div class="stat-label">Active Clients</div>
            <div class="stat-value" style="color: var(--brand-secondary);">{{ total_clients }}</div>
            <div class="stat-change positive">
                <span>â†‘</span>
                <span>3 this month</span>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-label">Active Programs</div>
            <div class="stat-value" style="color: var(--color-success);">{{ total_programs }}</div>
            <div class="stat-change positive">
                <span>â†‘</span>
                <span>2 new programs</span>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-label">Today's Sessions</div>
            <div class="stat-value" style="color: var(--brand-primary);">{{ today_sessions|length }}</div>
            <div class="stat-change positive">
                <span>âœ“</span>
                <span>On schedule</span>
            </div>
        </div>
        
        <div class="stat-card">
            <div class="stat-label">Upcoming Sessions</div>
            <div class="stat-value" style="color: var(--color-info);">{{ upcoming_sessions|length }}</div>
            <div class="stat-change">
                <span>â†’</span>
                <span>Next 7 days</span>
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="card" style="margin-bottom: var(--space-8);">
        <div class="card-header">
            <h2 class="card-title">Quick Actions</h2>
        </div>
        <div class="card-body">
            <div class="grid-4">
                <a href="{{ url_for('clients.add_client') }}" class="btn btn-primary btn-lg">
                    <span style="font-size: 1.25rem;">âž•</span>
                    <span>Add Client</span>
                </a>
                <a href="{{ url_for('sessions.add_session') }}" class="btn btn-primary btn-lg">
                    <span style="font-size: 1.25rem;">ðŸ“…</span>
                    <span>Schedule Session</span>
                </a>
                <a href="{{ url_for('programs.add_program') }}" class="btn btn-secondary btn-lg">
                    <span style="font-size: 1.25rem;">ðŸ“‹</span>
                    <span>Create Program</span>
                </a>
                <a href="{{ url_for('exercise_library.index') }}" class="btn btn-outline btn-lg">
                    <span style="font-size: 1.25rem;">ðŸ’ª</span>
                    <span>Exercise Library</span>
                </a>
            </div>
        </div>
    </div>
    
    <!-- Today's Sessions -->
    {% if today_sessions %}
    <div class="card" style="margin-bottom: var(--space-8);">
        <div class="card-header">
            <h2 class="card-title">Today's Sessions</h2>
        </div>
        <div class="card-body" style="padding: 0;">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Client</th>
                            <th>Session Type</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for session in today_sessions %}
                        <tr>
                            <td><strong>{{ session.scheduled_start.strftime('%H:%M') }}</strong></td>
                            <td>{{ session.client.full_name }}</td>
                            <td><span class="badge badge-info">{{ session.session_type|title }}</span></td>
                            <td><span class="badge badge-success">{{ session.status|title }}</span></td>
                            <td>
                                <a href="{{ url_for('sessions.view_session', session_id=session.id) }}" class="btn btn-sm btn-primary">View</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Upcoming Sessions -->
    {% if upcoming_sessions %}
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Upcoming Sessions</h2>
        </div>
        <div class="card-body" style="padding: 0;">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Date & Time</th>
                            <th>Client</th>
                            <th>Title</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for session in upcoming_sessions %}
                        <tr>
                            <td><strong>{{ session.scheduled_start.strftime('%b %d, %H:%M') }}</strong></td>
                            <td>{{ session.client.full_name }}</td>
                            <td>{{ session.title }}</td>
                            <td>
                                <a href="{{ url_for('sessions.view_session', session_id=session.id) }}" class="btn btn-sm btn-outline">View</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Recent Clients -->
    {% if recent_clients %}
    <div class="card" style="margin-top: var(--space-8);">
        <div class="card-header">
            <h2 class="card-title">Recent Clients</h2>
        </div>
        <div class="card-body" style="padding: 0;">
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Fitness Goal</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for client in recent_clients %}
                        <tr>
                            <td><strong>{{ client.full_name }}</strong></td>
                            <td>{{ client.email }}</td>
                            <td><span class="badge badge-primary">{{ client.fitness_goal or 'Not specified' }}</span></td>
                            <td>
                                <a href="{{ url_for('clients.view_client', client_id=client.id) }}" class="btn btn-sm btn-ghost">View Profile</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
{% endblock %}
